#一些Ruby学习笔记

上个周五，经历了职业生涯的第一次code review，当然不出意料的被大牛们发现了各种毛病，不过收获还是有的，这个礼拜又按照mentor的意思把代码好好重构了一下，现在代码终于好看一点了。

这次code review之后的改动，可以说是相当之大，而且跟着同事学习，也让我的效率大大提高，具体的学习内容我将在下篇博客写，这篇主要讲最近一段时间的学习成果。

#####RailsGuides部分

1. 在```create```动作中，如果保存失败，调用的是```render```方法而不是```redirect_to```方法。用```render```方法才能在保存失败后把```@article```对象传给```new```动作的视图。渲染操作和表单提交在同义词请求中完成，而```redirect_to```会让浏览器发起一次新的请求。  
	两者的参数不一样，分别为：  
	- ```render```的参数是方法名对应的symbol，即```render :new```；
	- ```redirect_to```的参数是```path```参数，即```redirect_to new_article_path```。  
2. 测试了一下，RailsGuides上面的```render```用法，如果单纯的```render partial```，即使同名，好像也没法把示例变量当做本地变量使用，最好还是使用```locals```参数。这样一来，```as```这个参数就没有存在的必要了啊。。。
3. 渲染间隔模板一般和组合模板一起渲染。
4. ```render```只是渲染模板，如果模板里没有需要显示的内容，```render```也不会显示，当时用```yield```之类的方法时，可以把外部代码写在一个模板里，然后在需要调用的地方使用```render```引用模板。  
5. ```redierct_to```有一个非常有一次的重定向，即```redirect_to :back```，返回之前的页面。
6. ```redirect_to```是重定向，如果参数是一个```action```，那么这个操作会把这个```action```里的代码执行一边，但是```render```仅仅是渲染操作，只会渲染动作相关的视图，而不会执行```action```里的代码。

#####其余的零零碎碎
1. 在判断空的时候，不要使用```== nil```、```=== []```这样的手段，多使用```.nil?```、```.empty?```等方法，前者太low。
2. 在Rails里，```controller```负责内部逻辑(?)，```model```是数据模型，```view```是页面视图，目前看来，```controller```这一层应该尽量干净。
3. 和模型本身相关的```validate```等操作，尽量放到```model```里来做，比如模型有没有某一表项等判断，比如在```contoller```取值按照一定顺序```sort```，这些都应该尽量在```model```里来完成，因为这是数据本身的操作。
4. 如果在```model```里的操作实在不够要求，那么可以为```view```建立```helper```，按照Rails框架的定义，所有```views/xxx/yyy.html.erb```这样的视图，都可以调用```helpers/xxx_helper.rb```里面的方法。
5. ```pry-rails```是个好东西，```binding.pry```和```rails c```在这个gem的帮助下让开发Rails应用的调试简直成为了一种乐趣。
6. ```ActiveRecord```提供了判断行是否存在的方法，即```exists?```，接收一个哈希，返回```true```或```false```。
7. 如果任务可以在前端完成的话，尽量在前端完成，比如表单的```validation```，因为Ruby是很慢的，即使Ruby不慢，将数据```post```到后台完成验证再返回到前端，这样的过程本身就是浪费。